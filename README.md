<div align=center><a href="https://myseoulguide.site"><img src="https://user-images.githubusercontent.com/74864925/129395349-90ca9abc-6b1a-4989-b98a-aadfec7ff383.png"/></a></div>

# <div align=center>My Seoul Guide</div>

#### <div align=center>This is for your trip, This is your Seoul.</div>

<br/>

<div align=center>
<img src="https://travis-ci.org/joemccann/dillinger.svg?branch=master"/>&nbsp;
  <img src="https://img.shields.io/github/stars/noah071610/My-Seoul-Guide?style=social"/>&nbsp;
  <img src="https://img.shields.io/github/watchers/noah071610/My-Seoul-Guide?style=social"/>&nbsp;
</div>

<br/>

<div align=center>
<img src="https://img.shields.io/badge/Photoshop-31A8FF?style=flat-square&logo=adobe-photoshop&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/HTML5-E34F26?style=flat-square&logo=HTML5&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/CSS3-1572B6?style=flat-square&logo=CSS3&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/SCSS-CC6699?style=flat-square&logo=Sass&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/JavaScript-F7DF1E?style=flat-square&logo=JavaScript&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/TypeScript-3178C6?style=flat-square&logo=TypeScript&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/React-61DAFB?style=flat-square&logo=React&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/MobX-FF9955?style=flat-square&logo=MobX&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/Emotion-DB7093?style=flat-square&logo=styled-components&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/Antd-0170FE?style=flat-square&logo=Ant-design&logoColor=white"/>&nbsp; <br/>
<img src="https://img.shields.io/badge/Node.js-339933?style=flat-square&logo=node-dot-js&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/GraphQL-E434AA?style=flat-square&logo=GraphQL&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/Apollo-311C87?style=flat-square&logo=Apollo-GraphQL&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/Google_Map-4285F4?style=flat-square&logo=Google-Maps&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/Babel-F9DC3E?style=flat-square&logo=Babel&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/Webpack-8DD6F9?style=flat-square&logo=Webpack&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/Amazon_AWS-232F3E?style=flat-square&logo=Amazon-AWS&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/Linux-FCC624?style=flat-square&logo=Linux&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/NGINX-009639?style=flat-square&logo=NGINX&logoColor=white"/>&nbsp;
<img src="https://img.shields.io/badge/PM2-2B037A?style=flat-square&logo=PM2&logoColor=white"/>&nbsp;
</div>

<br/>

<div align=center>
  <a href="https://github.com/noah071610" target="_blank"><img src="https://image.flaticon.com/icons/png/24/25/25657.png"/></a>&nbsp;
  <a href="https://www.instagram.com/salmonchobab" target="_blank"><img src="https://image.flaticon.com/icons/png/24/1409/1409946.png"/></a>&nbsp;
  <a href="mailto:noah071610@naver.com"><img src="https://image.flaticon.com/icons/png/24/552/552486.png"/></a>&nbsp;
  <a href=href="https://noahworld.site/portfolio" target="_blank"><img src="https://image.flaticon.com/icons/png/24/3135/3135715.png"/></a>&nbsp;
</div>

<br/>

<div align=center>
  <a href="https://myseoulguide.site"><img src="https://img.shields.io/badge/go_to_website-EFFDFF?style=for-the-badge"/>&nbsp;</a>
</div>

<br/><br/><br/><br/><br/>

## 🎉 YES, This is your Seoul.

<br/>

2018년부터 2019년까지 개인적으로 서울에 오는 많은 외국인 관광객을 상대로 조사해본 결과

서울에는 볼거리가 넘쳐나 최적의 동선을 계획하는 것과 자신의 성향에 맞는 숙박 지역을

선택하는 데 많은 시간을 소비한다고 합니다. 저는 구글맵 API와 한국관광공사 OPEN API 그리고

고객에 성향에 맞춘 숙박 지역 추천 알고리즘을 자체적으로 만들어 이를 이용해 서울에 오는

외국인이 체계적으로 동선을 계획하고 편하게 관광할 수 있도록 이 웹앱 애플리케이션을

기획했습니다

<br/><br/>

## 🛫 프로젝트 기본 정보

<br/>

- 제작기간 : 2021/4 ~ 2021/6
- 개발자 : 장현수 (Noah) 외 0명
- 개발포지션 : 디자인 , 프론트엔드 , 백엔드 , 배포
- 언어 : English (日本語は間もなくアップデート予定です 🔜)
- 반응형 웹 사이트

<br/><br/>

## 🚝 Let's go into Center of Seoul.

<br/><br/>

### 1. 아름다운 서울의 전경을 시작으로 고객의 여행 성향과 인원 등을 미리 수집합니다.

- 이용자의 취향은 이용자에게 맞는 명소 및 맞춤 숙박지역을 추천하기위해서 사용합니다.
  <br/>

<div align=center>
  <img src="https://jshyunsoo.site/images/myseoulguide/myseoulguide_landing1.png" alt="myseoulguide_landing1"/>
  <img src="https://jshyunsoo.site/images/myseoulguide/myseoulguide_landing2.png" alt="myseoulguide_landing2"/>
</div>

<br/>

### 2. 취향에 맞춘 숙박지역 및 명소 데이터를 가져옵니다.

- 이용자의 취향을 내장된 데이터를 토대로 분석해 점수를 매긴후 숙박지역 매칭순위 상위2개의 가져옵니다.

```javascript
📁store.ts

  onSubmit: action(() => {
    const map = new Map();
    const recommendsArr: string[] = [];
    //유저에게 받은 정보를 저장합니다.
    let userInfo = {
      //클라이언트에서 걸러주기때문에 typeScript에 !를 이용했습니다.
      gender: checkListStore.gender!,
      age: checkListStore.age!,
      party: checkListStore.party!,
      acm: [...checkListStore.acm],
      purpose: [...checkListStore.purpose],
    };

    //놀거리 추천에 이용할 항목과 특수키는 사전에 따로 분류합니다.
    for (const v of checkListStore?.purpose) {
      switch (v) {
        case "Food":
          recommendsArr.push(userInfo.purpose.splice(userInfo.purpose.indexOf(v), 1)[0]);
          break;
        case "Shopping":
          recommendsArr.push(userInfo.purpose.splice(userInfo.purpose.indexOf(v), 1)[0]);
          break;
        case "K-pop":
          recommendsArr.push(userInfo.purpose.splice(userInfo.purpose.indexOf(v), 1)[0]);
          break;
        case "Native Recommendation":
          userInfo.purpose.splice(userInfo.purpose.indexOf(v), 1);
          break;
        case "Plastic surgery":
          userInfo.purpose.splice(userInfo.purpose.indexOf(v), 1);
          break;
      }
    }

    //숙박 추천에 이용할 항목을 담습니다.
    let userPick = [...userInfo.purpose, ...userInfo.acm, userInfo.age];

    //숙박 추천에 관한 데이터를 ID와 value값으로 가져옵니다.
    const places = valueList.map((v) => {
      return { id: v.id, valueList: v.values.sort() };
    });

    //=========== Recommend Stay finder start =================

    // 해시맵과 그 메쏘드를 이용한 알고리즘입니다. 점수산출은 기존점수 나누기 이용자의 항목선택수 에 따릅니다.
    for (let i = 0; i < userPick.length; i++) {
      for (let j = 0; j < places.length; j++) {
        places[j].valueList.forEach((place) => {
          if (place.value === userPick[i]) {
            if (map.get(places[j].id)) {
              map.set(
                places[j].id,
                map.get(places[j].id) + Math.floor(place.rate / userPick.length)
              );
            } else {
              map.set(places[j].id, Math.floor(place.rate / userPick.length));
            }
          }
        });
      }
    }

    //분류를 위해 해시맵으로 되어있는 데이터를 다시 id와 cnt(획득점수)로 배열화하고 cnt순으로 내림차 정렬합니다.
    let rankPlace = Array.from(map, ([id, cnt]) => ({ id, cnt })).sort((a, b) => b.cnt - a.cnt);

    //===== special Key ======
    //이용자의 항목에 특수키가 있으면 rankPlace에서 순위 변경 작업이 일어납니다.
    //서울인들은 명동을 추천하지않습니다. 대체제도 많고요.  Native Recommendation 이라면 명동은 제외시켜버립니다.
    //서울 여러분은 명동을 추천하시나요?? 이견이 있으시면 언제든지 피드백 주세요.
    if (checkListStore.purpose.includes("Native Recommendation")) {
      rankPlace = rankPlace.filter((v) => v.id !== 1);
    }
    //강남은 성형에 성지입니다. 성형을 원한다면 강남의 순위를 맨위로 올립니다.
    if (checkListStore.purpose.includes("Plastic surgery")) {
      rankPlace.unshift(rankPlace.splice(rankPlace.map((v) => v.id).indexOf(3), 1)[0]);
    }

    //상위 두개만 추천할거기 때문에 상위 2곳에 값만 따로 때옵니다.
    let solution = rankPlace.slice(0, 2).map((v) => {
      return placeList[v.id - 1];
    });

    solution.forEach((v, i) => (v.point = rankPlace[i].cnt));

    //=================^^ Recommend Stay finder done. ^^=====================
```

<br/>

### 3. 사용법 안내 및 숙박지역 및 놀거리를 추천합니다.

- 매칭률이 높은 숙박지역과 명소를 알맞게 제공하고 Home , Accomodation , Attraction 메뉴에서 각각 경로 추가 탐색 및 세부정보를 확인 할 수 있습니다.

<div align=center>
<img src="https://jshyunsoo.site/images/myseoulguide/myseoulguide_main_modal.jpg" alt="myseoulguide_main_modal"/>
  <img src="https://jshyunsoo.site/images/myseoulguide/myseoulguide_attraction_select.gif" alt="myseoulguide_attraction_select"/>
  <img src="https://jshyunsoo.site/images/myseoulguide/myseoulguide_attraction_page.gif" alt="myseoulguide_attraction_page"/>
  <img src="https://jshyunsoo.site/images/myseoulguide/myseoulguide_acm_select.jpg" alt="myseoulguide_acm_select"/>
  </div>

```javascript

  📁ActivityModal.tsx

    export const ActivityModal = observer(() => {
      const onClickCard = useCallback((arg: TogoRecommedInter) => {
        //추천 놀거리를 클릭하면 메인페이지의 구글맵에 반영되게 합니다.
        const form = {
          path: { lat: parseFloat(arg.mapy._text), lng: parseFloat(arg.mapx._text) },
          title: arg.title._text,
          contentid: arg.contentid._text,
        };
        if (mainStore.togoLists.find((togo) => togo.contentid === form.contentid)) {
          //만약 이미 체크한 상태에서 다시 클릭한다면 리스트에서 삭제합니다.
          mainStore.deleteTogoList(form.contentid);
        } else {
          mainStore.addTogoList(form);
        }
      }, []);
      const { loading, error, data } = useQuery(GET_RECOMMEND, {
        variables: {
          ...
        },
      });

      return (

        ...

        <div className="recommend_container">
            {useSortList({ data: data, isKpop: mainStore.userInfo?.purpose.includes("K-pop") })?.map(
              (v: TogoRecommedInter, i: number) => (
                <div key={i} onClick={() => onClickCard(v)} className="recommend_card">
                  <img
                    className="recommend_img"
                    src={v.firstimage?._text || NO_IMAGE_URL}
                    alt={v.firstimage?._text || "no_image"}
                  />
                  <h4>{v.title._text}</h4>
                  {mainStore.togoLists.find((togo) => togo.contentid === v.contentid._text) && (
                    <img
                      alt="checked"
                      className="recommend_checked"
                      src="https://img.icons8.com/emoji/48/000000/check-box-with-check-emoji.png"
                    />
                  )}
                </div>
              )
            )}
          </div>

          ...

```

<br/>

### 4. HOME에는 지정 숙소 및 가고싶은 명소의 내용이 담겨있습니다.

- 숙박지역과 명소까지 경로 탐색, 삭제등이 가능하며, Attractions 메뉴에서 명소 추가가 가능합니다

<br/>

<div align=center><img src="https://jshyunsoo.site/images/myseoulguide/myseoulguide_main_map.gif" alt="myseoulguide_main_map"/></div>

```javascript


  📁Home.tsx

          ...

    <LoadScript googleMapsApiKey={process.env.REACT_APP_MAP_CLIENT_ID as string}>
          <GoogleMap
            mapContainerStyle={mapContainerStyle}
            center={
            // 숙박지역이 정해져있지 않다면 서울의 정중앙을 center 좌표로 삼습니다.
              mainStore.place?.stationPath || { lat: 37.549687466128496, lng: 126.9809660539474 }
            }
            zoom={12}
          >
            {mainStore.place && (
              <OverlayView
                position={mainStore.place?.stationPath}
                mapPaneName={OverlayView.OVERLAY_MOUSE_TARGET}
              >
                <Preview>
                  <h3>Your base place</h3>
                  <h4>{mainStore.place?.title._text}</h4>
                  <span>🌟</span>
                </Preview>
              </OverlayView>
            )}
            {mainStore.togoLists.length > 0 &&
              mainStore.togoLists.map((v, i) => {
                return (
                  <OverlayView
                    key={i}
                    position={v.path}
                    mapPaneName={OverlayView.OVERLAY_MOUSE_TARGET}
                  >
                    <Popover content={() => togoPopup(v.contentid, v.path)}>
                      <Preview>
                        <h3>List No.{i + 1}</h3>
                        <h4>{v.title}</h4>
                        <span>📍</span>
                      </Preview>
                    </Popover>
                  </OverlayView>
                );
              })}
            {toPlacePath && (
              // Direction 부분은 코드량이 길어져서 따로 별개의 컴포넌트를 분리해두었습니다.
              <Directions origin={mainStore.place?.stationPath} destination={toPlacePath} />
            )}
          </GoogleMap>
        </LoadScript>


```

<br/>

### 5. 지정 숙박지역 및 공항까지의 경로를 탐색할 수 있으며 최적의 동선을 탐색할 수 있습니다.

- 구글 맵 API의 경로시스템과 개인적으로 수집한 관광 데이터 등을 적극 이용합니다.

<br/>

<div align=center><img width="700px" src="https://jshyunsoo.site/images/myseoulguide/myseoulguide_acm_page.png" alt="myseoulguide_acm_page"/><img src="https://jshyunsoo.site/images/myseoulguide/myseoulguide_route_page.gif" alt="myseoulguide_route_page"/></div>

```javascript
  📁MapPage.tsx

    const AcmAndRoutePage: FC = observer(() => {
      const { path } = useRouteMatch();
      // useRouteMatch 로 현재가 Accommodation 메뉴인지 Airport 메뉴인지 파악합니다.
      let isAirportRoutePath = path.slice(1) === "airport_route";
      const [center, setCenter] = useState<PathObj>({
        lat: 37.517146640932296,
        lng: 126.80792769408053,
      });

      useEffect(() => {
        if (!isAirportRoutePath && mainStore.place) {
          let centerXY = useCalcCenter(mainStore.place?.path as PathObj[]);
          //doubleCheck
          setCenter(centerXY);
        }
        // eslint-disable-next-line react-hooks/exhaustive-deps
      }, [isAirportRoutePath, mainStore.place]);

      return (
        <MainPageWrapper>
          <LoadScript googleMapsApiKey={process.env.REACT_APP_MAP_CLIENT_ID as string}>
            <GoogleMap
              mapContainerClassName={isAirportRoutePath ? "map_route" : "map_acm"}
              center={center}
              zoom={isAirportRoutePath ? 10 : 13}
            >
              {isAirportRoutePath ? (
                //You can see direction when you pick airport up
                mainStore.airport && (
                  <Directions
                    origin={{
                      lat: mainStore.airport.path.lat,
                      lng: mainStore.airport.path.lng,
                    }}
                    destination={{
                      lat: mainStore.destination?.stationPath.lat,
                      lng: mainStore.destination?.stationPath.lng,
                    }}
                  />
                )
              ) : (
                //Polygon map area for acm page
                <Polygon paths={mainStore?.place?.path} options={polygonOption} />
              )}
            </GoogleMap>
          </LoadScript>
          {isAirportRoutePath ? (
            <AirportRouteCards />
          ) : (
            mainStore.place && <PlaceCards card={mainStore.place} isAcmCard={true} />
          )}
        </MainPageWrapper>
      );
    });

    export default AcmAndRoutePage;


```

<br/>

### 6. Analyzer 페이지에서 예산과 지출을 파악할 수 있습니다.

- 예산을 입력하고 지출을 기록하면 파이차트에 표시되며 남은예산 등을 손쉽게 파악합니다.

<br/>

<div align=center><img src="https://jshyunsoo.site/images/myseoulguide/myseoulguide_analyzer_setting.gif" alt="myseoulguide_analyzer_setting"/><img src="https://jshyunsoo.site/images/myseoulguide/myseoulguide_analyzer_ledger.gif" alt="myseoulguide_analyzer_ledger"/></div>

```javascript

  📁LedgerModal.tsx

    const LedgerModal = observer(
      ({ currentExchage, isModalVisible, setIsModalVisible }: AnalyzerContentProps) => {
        const [memo, onChangeMemo, setMemo] = useInput("");
        const [payment, onChangePayment, setPayment] = useInput(null);
        const [select, setSelect] = useState("");
        const onChangeSelect = useCallback((value: string) => {
          setSelect(value);
        }, []);

        const onSubmit = useCallback(() => {
          //입력을 안한 부분이 있다면 요청을 취소합니다.
          if (!payment || !select) {
            message.error("Please fill contents up");
            return;
          }
          // 날짜를 위한 데이터를 만듭니다.
          const date = new Date();
          const year = date.getFullYear();
          const month = ("0" + (1 + date.getMonth())).slice(-2);
          const day = ("0" + date.getDate()).slice(-2);
          let form = {
            date: year + "/" + month + "/" + day,
            type: select,
            // 환율정보를 제공하는 API를 이용하여 USD 를 KRW로 변환합니다.
            // 환율api가 https는 유료로만 제공하고 매우 비싸며 요청한도도 적어서 임시방편으로 1 USD = 1300 KRW 고정값을 넣었습니다
            // 만약 추후에 필요하다면 유료결제해서 사용하겠습니다. (장현수 : 2021/06/04)
            payment: useExchageClac(payment, currentExchage),
            memo,
          };
          // 데이터를 store에 전달합니다.
          analyzerStore.addPaymentList(form);
          setMemo("");
          setPayment("");
        }, [currentExchage, memo, payment, select, setMemo, setPayment]);

        return (
          <LedgerModalComponent
            title="Ledger"
            visible={isModalVisible}
            onCancel={() => setIsModalVisible(false)}
            footer={false}
            className="analyzer_input"
          >

          ....


```

<br/><br/><br/>

## 🎯 What made you to go Seoul?

<br/>

> 🎤 : GraphQL 어떤가요?

RestAPI의 오버패칭과 언더패칭문제가 한국관광공사 OPEN API에서 정말 치명적이었습니다. 이런 치명적인 단점을 GraphQL이 효율적으로 개선시켜줬기 때문에 매우 만족하지만, Express 와 NestJS보단 익숙하지 않기 때문에 공부가 더욱 더 필요합니다.

<br/>

> 🎤 : 근데 프로젝트에 GraphQL이 없던데 어떻게 된 일인가요?

"코드는 안쓰는게 최고의 코드다." 라는 모토로 한두번의 API요청을 위해 서버를 따로두는건 현실적으로 이해타산이 맞지 않는다고 생각하였고, 배포 후 유지보수 과정에서 GraphQL과 Apollo Client를 삭제하고 서버리스 프로젝트로 바꾸었습니다.

<br/>

> 🎤 : 지도관련 라이브러리는 어떤게 좋나요?

네이버맵과 카카오맵은 영어를 지원하지 않고 구글은 영어를 지원합니다. 그러나 대한민국이 국가보안 문제로 구글에 세부적인 지도내용을 공개하지 않기에 라이브러리 선정이 골치 아팠습니다. 고민 끝에 프로젝트의 정체성이 외국인에게 서울을 소개하는 영어로만 이루어진 프로젝트이기에 영어를 지원하는 구글맵을 선택했습니다. 차기프로젝트인 'Fall IN Asia' 에서는 이용이 간편하고 API 한도 제약이 거의 없는 우버의 MapBox를 사용했습니다.

<br/>

> 🎤 : Redux VS MobX

MobX의 경우에는 보다 로직이 간단하지만 Redux같은 경우엔 DevTool이 매우 직관적이고 강력하며 Saga 나 Thunk 같은 라이브러리를 같이 이용하면 시너지가 어마어마합니다. 간단한 프로젝트엔 MobX를, 대규모나 실무에선 Redux가 적합한거 같습니다. 둘다 훌륭한 상태관리 라이브러리입니다. 차기프로젝트인 'Fall IN Asia' 에서는 강력한 Data Fetching 라이브러리인 SWR과 Redux의 무거움을 덜어주는 Redux-toolkit을 혼용해서 사용했습니다.

<br/><br/><br/>

## 🎯 Why pronunciation of Seoul is similar to Soul?

<br/>

> 🎤 : 개발과정 중 힘들었던 부분과 피드백은?

<br/>

- API 요청은 돈이다 라는것을 몸소 체험했습니다. 요청 한도초과되서 당황했던 기억이 납니다.

- Emotion 라이브러리로 인해 CRA에 기본설정을 해체하는데 시간이 걸렸고 대신 CRA의 장단점및 craco 사용법을 알게 되었습니다.

- 메뉴(navigation)가 그렇게 중요한 컴포넌트가 아닌데도 불구하고 세세한 부분에도 심혈을 기울이다보니 상당히 로직이 복잡해지고 시간도 오래 걸리게 되었습니다. 차기 프로젝트 'Fall In Asia'에서는 로직과 컴포넌트의 중요성을 따져 시간을 할애하도록 노력했습니다.

- 최대한 컴포넌트의 재사용성을 위해서 힘썼지만 복잡한 로직에 가독성도 떨어지게 되었습니다. 그냥 컴포넌트 하나 더 만드는게 여러모로 나을듯 한데 욕심 부린것 같습니다. 차기 프로젝트 'Fall In Asia'에서는 기획초기에 투박하지만 스케치로 와이어프레임을 그리며 미리 계획적으로 컴포넌트를 분리했습니다.

- SCSS를 사용할건지 CSS-in-JS 를 사용할건지 선택해야되는데 애매하게 둘다 사용해 효율이 떨어졌습니다. 또한 클래스명 작명이 힘들었고 따라서 협업시 코딩컨벤션을 잘 따라야할 필요성을 느꼈습니다. 이후 차기 프로젝트 'Fall IN Asia' 에서 Emotion에 TailWindCSS를 넣어 CSS-in-JS만 사용했습니다.

<br/><br/><br/>

## 🌇 Before you go back your place from Seoul.

<br/>

> 🎤 : 구경갈래요!

#### <a href="https://myseoulguide.site">마이서울가이드 바로가기</a>

<br/>

> 🎤 : 업데이트 상황을 알려주세요

<br/>

| Date       | Version | Update                                                         |
| ---------- | ------- | -------------------------------------------------------------- |
| 2020/06/04 | v1.0    | Final Update for first deployment through AWS                  |
| 2020/08/13 | v1.1    | Optimizated Components ,Stylesheet and Rebuild Attraction page |
| 2020/11/07 | v2.0    | Remove GraphQL Server for Serverless                           |

<br/>

> 🎤 : 마지막으로 하고 싶은말은?

<br/>

피드백은 항상 저를 성장시키게 합니다.

궁금한게 있으시면 noah071610@gmail.com 으로 언제든지 편하게 연락주세요.

<br/><br/><br/>
